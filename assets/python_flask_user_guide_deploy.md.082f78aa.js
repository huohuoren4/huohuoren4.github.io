import{_ as s,o as a,c as e,X as n}from"./chunks/framework.b5656a4e.js";const D=JSON.parse('{"title":"Deploying to Production","description":"","frontmatter":{},"headers":[],"relativePath":"python/flask/user_guide/deploy.md","filePath":"python/flask/user_guide/deploy.md","lastUpdated":1692979908000}'),o={name:"python/flask/user_guide/deploy.md"},l=n(`<h1 id="deploying-to-production" tabindex="-1">Deploying to Production <a class="header-anchor" href="#deploying-to-production" aria-label="Permalink to &quot;Deploying to Production {#deploying-to-production}&quot;">​</a></h1><p>After developing your application, you’ll want to make it available publicly to other users. When you’re developing locally, you’re probably using the built-in development server, debugger, and reloader. These should not be used in production. Instead, you should use a dedicated WSGI server or hosting platform, some of which will be described here.</p><p>“Production” means “not development”, which applies whether you’re serving your application publicly to millions of users or privately / locally to a single user. Do not use the development server when deploying to production. It is intended for use only during local development. It is not designed to be particularly secure, stable, or efficient.</p><h2 id="self-hosted-options" tabindex="-1">Self-Hosted Options <a class="header-anchor" href="#self-hosted-options" aria-label="Permalink to &quot;Self-Hosted Options {#self-hosted-options}&quot;">​</a></h2><p>Flask is a WSGI application. A WSGI server is used to run the application, converting incoming HTTP requests to the standard WSGI environ, and converting outgoing WSGI responses to HTTP responses.</p><p>The primary goal of these docs is to familiarize you with the concepts involved in running a WSGI application using a production WSGI server and HTTP server. There are many WSGI servers and HTTP servers, with many configuration possibilities. The pages below discuss the most common servers, and show the basics of running each one. The next section discusses platforms that can manage this for you.</p><ul><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/gunicorn/" target="_blank" rel="noreferrer">Gunicorn</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/waitress/" target="_blank" rel="noreferrer">Waitress</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/mod_wsgi/" target="_blank" rel="noreferrer">mod_wsgi</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/uwsgi/" target="_blank" rel="noreferrer">uWSGI</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/gevent/" target="_blank" rel="noreferrer">gevent</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/eventlet/" target="_blank" rel="noreferrer">eventlet</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/asgi/" target="_blank" rel="noreferrer">ASGI</a></li></ul><p>WSGI servers have HTTP servers built-in. However, a dedicated HTTP server may be safer, more efficient, or more capable. Putting an HTTP server in front of the WSGI server is called a “reverse proxy.”</p><ul><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/proxy_fix/" target="_blank" rel="noreferrer">Tell Flask it is Behind a Proxy</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/nginx/" target="_blank" rel="noreferrer">nginx</a></li><li><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/apache-httpd/" target="_blank" rel="noreferrer">Apache httpd</a> This list is not exhaustive, and you should evaluate these and other servers based on your application’s needs. Different servers will have different capabilities, configuration, and support.</li></ul><h2 id="hosting-platforms" tabindex="-1">Hosting Platforms <a class="header-anchor" href="#hosting-platforms" aria-label="Permalink to &quot;Hosting Platforms {#hosting-platforms}&quot;">​</a></h2><p>There are many services available for hosting web applications without needing to maintain your own server, networking, domain, etc. Some services may have a free tier up to a certain time or bandwidth. Many of these services use one of the WSGI servers described above, or a similar interface. The links below are for some of the most common platforms, which have instructions for Flask, WSGI, or Python.</p><ul><li><p><a href="https://help.pythonanywhere.com/pages/Flask/" target="_blank" rel="noreferrer">PythonAnywhere</a></p></li><li><p><a href="https://cloud.google.com/appengine/docs/standard/python3/building-app" target="_blank" rel="noreferrer">Google App Engine</a></p></li><li><p><a href="https://cloud.google.com/run/docs/quickstarts/build-and-deploy/deploy-python-service" target="_blank" rel="noreferrer">Google Cloud Run</a></p></li><li><p><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-flask.html" target="_blank" rel="noreferrer">AWS Elastic Beanstalk</a></p></li><li><p><a href="https://docs.microsoft.com/en-us/azure/app-service/quickstart-python" target="_blank" rel="noreferrer">Microsoft Azure</a></p></li></ul><p>This list is not exhaustive, and you should evaluate these and other services based on your application’s needs. Different services will have different capabilities, configuration, pricing, and support.</p><p>You’ll probably need to <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/proxy_fix/" target="_blank" rel="noreferrer">Tell Flask it is Behind a Proxy</a> when using most hosting platforms.</p><h2 id="gunicorn" tabindex="-1">Gunicorn <a class="header-anchor" href="#gunicorn" aria-label="Permalink to &quot;Gunicorn {#gunicorn}&quot;">​</a></h2><p><a href="https://gunicorn.org/" target="_blank" rel="noreferrer">Gunicorn</a> is a pure Python WSGI server with simple configuration and multiple worker implementations for performance tuning.</p><ul><li><p>It tends to integrate easily with hosting platforms.</p></li><li><p>It does not support Windows (but does run on WSL).</p></li><li><p>It is easy to install as it does not require additional dependencies or compilation.</p></li><li><p>It has built-in async worker support using gevent or eventlet.</p></li></ul><p>This page outlines the basics of running Gunicorn. Be sure to read its <a href="https://docs.gunicorn.org/" target="_blank" rel="noreferrer">documentation</a> and use <code>gunicorn --help</code> to understand what features are available.</p><h3 id="installing" tabindex="-1">Installing <a class="header-anchor" href="#installing" aria-label="Permalink to &quot;Installing {#installing}&quot;">​</a></h3><p>Gunicorn is easy to install, as it does not require external dependencies or compilation. It runs on Windows only under WSL.</p><p>Create a virtualenv, install your application, then install <code>gunicorn</code>.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">$ cd hello</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">app</span></span>
<span class="line"><span style="color:#A6ACCD;">$ python </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">m venv </span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">venv</span></span>
<span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">venv</span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">activate</span></span>
<span class="line"><span style="color:#A6ACCD;">$ pip install </span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">  </span><span style="color:#676E95;font-style:italic;"># install your application</span></span>
<span class="line"><span style="color:#A6ACCD;">$ pip install gunicorn</span></span></code></pre></div><h3 id="running" tabindex="-1">Running <a class="header-anchor" href="#running" aria-label="Permalink to &quot;Running {#running}&quot;">​</a></h3><p>The only required argument to Gunicorn tells it how to load your Flask application. The syntax is <code>{module_import}:{app_variable}</code>. module_import is the dotted import name to the module with your application. <code>app_variable</code> is the variable with the application. It can also be a function call (with any arguments) if you’re using the app factory pattern.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># equivalent to &#39;from hello import app&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello:app</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># equivalent to &#39;from hello import create_app; create_app()&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello:create_app()</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Starting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20.1</span><span style="color:#C3E88D;">.0</span></span>
<span class="line"><span style="color:#FFCB6B;">Listening</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">at:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1:8000</span><span style="color:#A6ACCD;"> (x)</span></span>
<span class="line"><span style="color:#FFCB6B;">Using</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sync</span></span>
<span class="line"><span style="color:#FFCB6B;">Booting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pid:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x</span></span>
<span class="line"><span style="color:#FFCB6B;">Booting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pid:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x</span></span>
<span class="line"><span style="color:#FFCB6B;">Booting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pid:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x</span></span>
<span class="line"><span style="color:#FFCB6B;">Booting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pid:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x</span></span></code></pre></div><p>The <code>-w</code> option specifies the number of processes to run; a starting value could be CPU * 2. The default is only 1 worker, which is probably not what you want for the default worker type.</p><p>Logs for each request aren’t shown by default, only worker info and errors are shown. To show access logs on stdout, use the <code>--access-logfile=-</code> option.</p><h3 id="binding-externally" tabindex="-1">Binding Externally <a class="header-anchor" href="#binding-externally" aria-label="Permalink to &quot;Binding Externally {#binding-externally}&quot;">​</a></h3><p>Gunicorn should not be run as root because it would cause your application code to run as root, which is not secure. However, this means it will not be possible to bind to port 80 or 443. Instead, a reverse proxy such as <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/nginx/" target="_blank" rel="noreferrer">nginx</a> or <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/apache-httpd/" target="_blank" rel="noreferrer">Apache httpd</a> should be used in front of Gunicorn.</p><p>You can bind to all external IPs on a non-privileged port using the <code>-b 0.0.0.0</code> option. Don’t do this when using a reverse proxy setup, otherwise it will be possible to bypass the proxy.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-b</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0.0</span><span style="color:#C3E88D;">.0.0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello:create_app()</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">Listening</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">at:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://0.0.0.0:8000</span><span style="color:#A6ACCD;"> (x)</span></span></code></pre></div><p><code>0.0.0.0</code> is not a valid address to navigate to, you’d use a specific IP address in your browser.</p><h3 id="async-with-gevent-or-eventlet" tabindex="-1">Async with gevent or eventlet <a class="header-anchor" href="#async-with-gevent-or-eventlet" aria-label="Permalink to &quot;Async with gevent or eventlet {#async-with-gevent-or-eventlet}&quot;">​</a></h3><p>The default sync worker is appropriate for many use cases. If you need asynchronous support, Gunicorn provides workers using either <a href="https://www.gevent.org/" target="_blank" rel="noreferrer">gevent</a> or <a href="https://eventlet.net/" target="_blank" rel="noreferrer">eventlet</a>. This is not the same as Python’s <code>async/await</code>, or the ASGI server spec. You must actually use <code>gevent/eventlet</code> in your own code to see any benefit to using the workers.</p><p>When using either gevent or <code>eventlet</code>, <code>greenlet</code>&gt;=1.0 is required, otherwise context locals such as <code>request</code> will not work as expected. When using <code>PyPy</code>, <code>PyPy</code>&gt;=7.3.7 is required.</p><p>To use <code>gevent</code>:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-k</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gevent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello:create_app()</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">Starting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20.1</span><span style="color:#C3E88D;">.0</span></span>
<span class="line"><span style="color:#FFCB6B;">Listening</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">at:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1:8000</span><span style="color:#A6ACCD;"> (x)</span></span>
<span class="line"><span style="color:#FFCB6B;">Using</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gevent</span></span>
<span class="line"><span style="color:#FFCB6B;">Booting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pid:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x</span></span></code></pre></div><p>To use <code>eventlet</code>:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-k</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eventlet</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello:create_app()</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">Starting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gunicorn</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20.1</span><span style="color:#C3E88D;">.0</span></span>
<span class="line"><span style="color:#FFCB6B;">Listening</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">at:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1:8000</span><span style="color:#A6ACCD;"> (x)</span></span>
<span class="line"><span style="color:#FFCB6B;">Using</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eventlet</span></span>
<span class="line"><span style="color:#FFCB6B;">Booting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pid:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x</span></span></code></pre></div><h2 id="waitress" tabindex="-1">Waitress <a class="header-anchor" href="#waitress" aria-label="Permalink to &quot;Waitress {#waitress}&quot;">​</a></h2><p><a href="https://docs.pylonsproject.org/projects/waitress/" target="_blank" rel="noreferrer">Waitress</a> is a pure Python WSGI server.</p><ul><li><p>It is easy to configure.</p></li><li><p>It supports Windows directly.</p></li><li><p>It is easy to install as it does not require additional dependencies or compilation.</p></li><li><p>It does not support streaming requests, full request data is always buffered.</p></li><li><p>It uses a single process with multiple thread workers.</p></li></ul><p>This page outlines the basics of running Waitress. Be sure to read its documentation and <code>waitress-serve --help</code> to understand what features are available.</p><h3 id="installing-1" tabindex="-1">Installing <a class="header-anchor" href="#installing-1" aria-label="Permalink to &quot;Installing {#installing-1}&quot;">​</a></h3><p>Create a virtualenv, install your application, then install <code>waitress</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello-app</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv/bin/activate</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># install your application</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">waitress</span></span></code></pre></div><h3 id="running-2" tabindex="-1">Running <a class="header-anchor" href="#running-2" aria-label="Permalink to &quot;Running {#running-2}&quot;">​</a></h3><p>The only required argument to <code>waitress-serve</code> tells it how to load your Flask application. The syntax is <code>{module}:{app}</code>. module is the dotted import name to the module with your application. <code>app</code> is the variable with the application. If you’re using the app factory pattern, use <code>--call {module}:{factory}</code> instead.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># equivalent to &#39;from hello import app&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">waitress-serve</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--host</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello:app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># equivalent to &#39;from hello import create_app; create_app()&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">waitress-serve</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--host</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--call</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello:create_app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Serving</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1:8080</span></span></code></pre></div><p>The <code>--host</code> option binds the server to local <code>127.0.0.1</code> only.</p><p>Logs for each request aren’t shown, only errors are shown. Logging can be configured through the Python interface instead of the command line.</p><h3 id="binding-externally-1" tabindex="-1">Binding Externally <a class="header-anchor" href="#binding-externally-1" aria-label="Permalink to &quot;Binding Externally {#binding-externally-1}&quot;">​</a></h3><p>Waitress should not be run as root because it would cause your application code to run as root, which is not secure. However, this means it will not be possible to bind to port 80 or 443. Instead, a reverse proxy such as <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/nginx/" target="_blank" rel="noreferrer">nginx</a> or <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/apache-httpd/" target="_blank" rel="noreferrer">Apache httpd</a> should be used in front of Waitress.</p><p>You can bind to all external IPs on a non-privileged port by not specifying the <code>--host</code> option. Don’t do this when using a revers proxy setup, otherwise it will be possible to bypass the proxy.</p><p><code>0.0.0.0</code> is not a valid address to navigate to, you’d use a specific IP address in your browser.</p><h2 id="mod-wsgi" tabindex="-1">mod_wsgi <a class="header-anchor" href="#mod-wsgi" aria-label="Permalink to &quot;mod_wsgi {#mod-wsgi}&quot;">​</a></h2><p><a href="https://modwsgi.readthedocs.io/" target="_blank" rel="noreferrer">mod_wsgi</a> is a WSGI server integrated with the <a href="https://httpd.apache.org/" target="_blank" rel="noreferrer">Apache httpd</a> server. The modern <a href="https://pypi.org/project/mod-wsgi/" target="_blank" rel="noreferrer">mod_wsgi-express</a> command makes it easy to configure and start the server without needing to write Apache httpd configuration.</p><ul><li><p>Tightly integrated with Apache httpd.</p></li><li><p>Supports Windows directly.</p></li><li><p>Requires a compiler and the Apache development headers to install.</p></li><li><p>Does not require a reverse proxy setup.</p></li></ul><p>This page outlines the basics of running mod_wsgi-express, not the more complex installation and configuration with httpd. Be sure to read the <a href="https://pypi.org/project/mod-wsgi/" target="_blank" rel="noreferrer">mod_wsgi-express</a>, <a href="https://modwsgi.readthedocs.io/" target="_blank" rel="noreferrer">mod_wsgi</a>, and <a href="https://httpd.apache.org/" target="_blank" rel="noreferrer">Apache httpd</a> documentation to understand what features are available.</p><h3 id="installing-2" tabindex="-1">Installing <a class="header-anchor" href="#installing-2" aria-label="Permalink to &quot;Installing {#installing-2}&quot;">​</a></h3><p>Installing mod_wsgi requires a compiler and the Apache server and development headers installed. You will get an error if they are not. How to install them depends on the OS and package manager that you use.</p><p>Create a virtualenv, install your application, then install <code>mod_wsgi</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello-app</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv/bin/activate</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># install your application</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mod_wsgi</span></span></code></pre></div><h3 id="running-1" tabindex="-1">Running <a class="header-anchor" href="#running-1" aria-label="Permalink to &quot;Running {#running-1}&quot;">​</a></h3><p>The only argument to <code>mod_wsgi-express</code> specifies a script containing your Flask application, which must be called <code>application</code>. You can write a small script to import your app with this name, or to create it if using the app factory pattern.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># wsgi.py</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> hello </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">application </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> app</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># wsgi.py</span></span>
<span class="line"><span style="color:#FFCB6B;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create_app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">application</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create_app</span><span style="color:#89DDFF;">()</span></span></code></pre></div><p>Now run the <code>mod_wsgi-express start-server</code> command.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mod_wsgi-express</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start-server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wsgi.py</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--processes</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span></span></code></pre></div><p>The <code>--processes</code> option specifies the number of worker processes to run; a starting value could be <code>CPU * 2</code>.</p><p>Logs for each request aren’t show in the terminal. If an error occurs, its information is written to the error log file shown when starting the server.</p><h3 id="binding-externally-3" tabindex="-1">Binding Externally <a class="header-anchor" href="#binding-externally-3" aria-label="Permalink to &quot;Binding Externally {#binding-externally-3}&quot;">​</a></h3><p>Unlike the other WSGI servers in these docs, mod_wsgi can be run as root to bind to privileged ports like 80 and 443. However, it must be configured to drop permissions to a different user and group for the worker processes.</p><p>For example, if you created a <code>hello</code> user and group, you should install your virtualenv and application as that user, then tell mod_wsgi to drop to that user after starting.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/home/hello/.venv/bin/mod_wsgi-express</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start-server</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">/home/hello/wsgi.py</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--group</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--port</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--processes</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span></span></code></pre></div><h2 id="uwsgi" tabindex="-1">uWSGI <a class="header-anchor" href="#uwsgi" aria-label="Permalink to &quot;uWSGI {#uwsgi}&quot;">​</a></h2><p><a href="https://uwsgi-docs.readthedocs.io/en/latest/" target="_blank" rel="noreferrer">uWSGI</a> is a fast, compiled server suite with extensive configuration and capabilities beyond a basic server.</p><ul><li><p>It can be very performant due to being a compiled program.</p></li><li><p>It is complex to configure beyond the basic application, and has so many options that it can be difficult for beginners to understand.</p></li><li><p>It does not support Windows (but does run on WSL).</p></li><li><p>It requires a compiler to install in some cases.</p></li></ul><p>This page outlines the basics of running uWSGI. Be sure to read its documentation to understand what features are available.</p><h3 id="installing-3" tabindex="-1">Installing <a class="header-anchor" href="#installing-3" aria-label="Permalink to &quot;Installing {#installing-3}&quot;">​</a></h3><p>uWSGI has multiple ways to install it. The most straightforward is to install the <code>pyuwsgi</code> package, which provides precompiled wheels for common platforms. However, it does not provide SSL support, which can be provided with a reverse proxy instead.</p><p>Create a virtualenv, install your application, then install <code>pyuwsgi</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello-app</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv/bin/activate</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># install your application</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pyuwsgi</span></span></code></pre></div><p>If you have a compiler available, you can install the <code>uwsgi</code> package instead. Or install the <code>pyuwsgi</code> package from sdist instead of wheel. Either method will include SSL support.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uwsgi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># or</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--no-binary</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pyuwsgi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pyuwsgi</span></span></code></pre></div><h3 id="running-4" tabindex="-1">Running <a class="header-anchor" href="#running-4" aria-label="Permalink to &quot;Running {#running-4}&quot;">​</a></h3><p>The most basic way to run uWSGI is to tell it to start an HTTP server and import your application.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uwsgi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--http</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1:8000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--master</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello:app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;"> Starting uWSGI 2.0.20 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">64bit</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> on </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">***</span></span>
<span class="line"><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;"> Operational MODE: preforking </span><span style="color:#89DDFF;">***</span></span>
<span class="line"><span style="color:#FFCB6B;">mounting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello:app</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">process</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cores:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cores:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cores:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cores:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>If you’re using the app factory pattern, you’ll need to create a small Python file to create the app, then point uWSGI at that.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># wsgi.py</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> hello </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> create_app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_app</span><span style="color:#89DDFF;">()</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uwsgi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--http</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1:8000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--master</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wsgi:app</span></span></code></pre></div><p>The <code>--http</code> option starts an HTTP server at 127.0.0.1 port 8000. The <code>--master</code> option specifies the standard worker manager. The <code>-p</code> option starts 4 worker processes; a starting value could be <code>CPU * 2</code>. The <code>-w</code> option tells uWSGI how to import your application</p><h3 id="binding-externally-2" tabindex="-1">Binding Externally <a class="header-anchor" href="#binding-externally-2" aria-label="Permalink to &quot;Binding Externally {#binding-externally-2}&quot;">​</a></h3><p>uWSGI should not be run as root with the configuration shown in this doc because it would cause your application code to run as root, which is not secure. However, this means it will not be possible to bind to port 80 or 443. Instead, a reverse proxy such as <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/nginx/" target="_blank" rel="noreferrer">nginx</a> or <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/apache-httpd/" target="_blank" rel="noreferrer">Apache httpd</a> should be used in front of uWSGI. It is possible to run uWSGI as root securely, but that is beyond the scope of this doc.</p><p>uWSGI has optimized integration with <a href="https://uwsgi-docs.readthedocs.io/en/latest/Nginx.html" target="_blank" rel="noreferrer">Nginx uWSGI</a> and <a href="https://uwsgi-docs.readthedocs.io/en/latest/Apache.html#mod-proxy-uwsgi" target="_blank" rel="noreferrer">Apache mod_proxy_uwsgi</a>, and possibly other servers, instead of using a standard HTTP proxy. That configuration is beyond the scope of this doc, see the links for more information.</p><p>You can bind to all external IPs on a non-privileged port using the <code>--http 0.0.0.0:8000</code> option. Don’t do this when using a reverse proxy setup, otherwise it will be possible to bypass the proxy.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uwsgi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--http</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0.0</span><span style="color:#C3E88D;">.0.0:8000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--master</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wsgi:app</span></span></code></pre></div><p><code>0.0.0.0</code> is not a valid address to navigate to, you’d use a specific IP address in your browser.</p><h3 id="async-with-gevent" tabindex="-1">Async with gevent <a class="header-anchor" href="#async-with-gevent" aria-label="Permalink to &quot;Async with gevent {#async-with-gevent}&quot;">​</a></h3><p>The default sync worker is appropriate for many use cases. If you need asynchronous support, uWSGI provides a gevent worker. This is not the same as Python’s <code>async/await</code>, or the ASGI server spec. You must actually use gevent in your own code to see any benefit to using the worker.</p><p>When using gevent, greenlet&gt;=1.0 is required, otherwise context locals such as <code>request</code> will not work as expected. When using PyPy, PyPy&gt;=7.3.7 is required.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uwsgi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--http</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">127.0</span><span style="color:#C3E88D;">.0.1:8000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--master</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--gevent</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wsgi:app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;"> Starting uWSGI 2.0.20 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">64bit</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> on </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">***</span></span>
<span class="line"><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;"> Operational MODE: async </span><span style="color:#89DDFF;">***</span></span>
<span class="line"><span style="color:#FFCB6B;">mounting</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello:app</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">process</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">worker</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cores:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">spawned</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uWSGI</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> (pid: </span><span style="color:#C3E88D;">x</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">***</span><span style="color:#A6ACCD;"> running gevent loop engine </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">addr:x</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">***</span></span></code></pre></div><h2 id="gevent" tabindex="-1">gevent <a class="header-anchor" href="#gevent" aria-label="Permalink to &quot;gevent {#gevent}&quot;">​</a></h2><p>Prefer using <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/gunicorn/" target="_blank" rel="noreferrer">Gunicorn</a> or <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/uwsgi/" target="_blank" rel="noreferrer">uWSGI</a> with gevent workers rather than using <a href="https://www.gevent.org/" target="_blank" rel="noreferrer">gevent</a> directly. Gunicorn and uWSGI provide much more configurable and production-tested servers.</p><p><a href="https://www.gevent.org/" target="_blank" rel="noreferrer">gevent</a> allows writing asynchronous, coroutine-based code that looks like standard synchronous Python. It uses <a href="https://greenlet.readthedocs.io/en/latest/" target="_blank" rel="noreferrer">greenlet</a> to enable task switching without writing <code>async/await</code> or using <code>asyncio</code>.</p><p><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/eventlet/" target="_blank" rel="noreferrer">eventlet</a> is another library that does the same thing. Certain dependencies you have, or other considerations, may affect which of the two you choose to use.</p><p>gevent provides a WSGI server that can handle many connections at once instead of one per worker process. You must actually use gevent in your own code to see any benefit to using the server.</p><h3 id="installing-4" tabindex="-1">Installing <a class="header-anchor" href="#installing-4" aria-label="Permalink to &quot;Installing {#installing-4}&quot;">​</a></h3><p>When using gevent, greenlet&gt;=1.0 is required, otherwise context locals such as <code>request</code> will not work as expected. When using PyPy, PyPy&gt;=7.3.7 is required.</p><p>Create a virtualenv, install your application, then install <code>gevent</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello-app</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv/bin/activate</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># install your application</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gevent</span></span></code></pre></div><h3 id="running-3" tabindex="-1">Running <a class="header-anchor" href="#running-3" aria-label="Permalink to &quot;Running {#running-3}&quot;">​</a></h3><p>To use <code>gevent</code> to serve your application, write a script that imports its <code>WSGIServer</code>, as well as your app or app factory.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># wsgi.py</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> gevent</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pywsgi </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> WSGIServer</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> hello </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> create_app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_app</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">http_server </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">WSGIServer</span><span style="color:#89DDFF;">((</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">8000</span><span style="color:#89DDFF;">),</span><span style="color:#82AAFF;"> app</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">http_server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">serve_forever</span><span style="color:#89DDFF;">()</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wsgi.py</span></span></code></pre></div><p>No output is shown when the server starts.</p><h3 id="binding-externally-4" tabindex="-1">Binding Externally <a class="header-anchor" href="#binding-externally-4" aria-label="Permalink to &quot;Binding Externally {#binding-externally-4}&quot;">​</a></h3><p>gevent should not be run as root because it would cause your application code to run as root, which is not secure. However, this means it will not be possible to bind to port 80 or 443. Instead, a reverse proxy such as <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/nginx/" target="_blank" rel="noreferrer">nginx</a> or <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/apache-httpd/" target="_blank" rel="noreferrer">Apache httpd</a> should be used in front of gevent.</p><p>You can bind to all external IPs on a non-privileged port by using <code>0.0.0.0</code> in the server arguments shown in the previous section. Don’t do this when using a reverse proxy setup, otherwise it will be possible to bypass the proxy.</p><p><code>0.0.0.0</code> is not a valid address to navigate to, you’d use a specific IP address in your browser.</p><h2 id="eventlet" tabindex="-1">eventlet <a class="header-anchor" href="#eventlet" aria-label="Permalink to &quot;eventlet {#eventlet}&quot;">​</a></h2><p>Prefer using <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/gunicorn/" target="_blank" rel="noreferrer">Gunicorn</a> with eventlet workers rather than using <a href="https://eventlet.net/" target="_blank" rel="noreferrer">eventlet</a> directly. Gunicorn provides a much more configurable and production-tested server.</p><p><a href="https://eventlet.net/" target="_blank" rel="noreferrer">eventlet</a> allows writing asynchronous, coroutine-based code that looks like standard synchronous Python. It uses <a href="https://greenlet.readthedocs.io/en/latest/" target="_blank" rel="noreferrer">greenlet</a> to enable task switching without writing <code>async/await</code> or using <code>asyncio</code>.</p><p><a href="https://flask.palletsprojects.com/en/2.3.x/deploying/gevent/" target="_blank" rel="noreferrer">gevent</a> is another library that does the same thing. Certain dependencies you have, or other considerations, may affect which of the two you choose to use.</p><p>eventlet provides a WSGI server that can handle many connections at once instead of one per worker process. You must actually use eventlet in your own code to see any benefit to using the server.</p><h3 id="installing-5" tabindex="-1">Installing <a class="header-anchor" href="#installing-5" aria-label="Permalink to &quot;Installing {#installing-5}&quot;">​</a></h3><p>When using <code>eventlet</code>, <code>greenlet</code>&gt;=1.0 is required, otherwise context locals such as <code>request</code> will not work as expected. When using PyPy, PyPy&gt;=7.3.7 is required.</p><p>Create a virtualenv, install your application, then install <code>eventlet</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello-app</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.venv/bin/activate</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># install your application</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eventlet</span></span></code></pre></div><h3 id="running-5" tabindex="-1">Running <a class="header-anchor" href="#running-5" aria-label="Permalink to &quot;Running {#running-5}&quot;">​</a></h3><p>To use eventlet to serve your application, write a script that imports its <code>wsgi.server</code>, as well as your app or app factory.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># wsgi.py</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> eventlet</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> eventlet </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> wsgi</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> hello </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> create_app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">create_app</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">wsgi</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">server</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">eventlet</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#89DDFF;">((</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">8000</span><span style="color:#89DDFF;">)),</span><span style="color:#82AAFF;"> app</span><span style="color:#89DDFF;">)</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wsgi.py</span></span>
<span class="line"><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">x</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> wsgi starting up on http://127.0.0.1:8000</span></span></code></pre></div><h3 id="binding-externally-5" tabindex="-1">Binding Externally <a class="header-anchor" href="#binding-externally-5" aria-label="Permalink to &quot;Binding Externally {#binding-externally-5}&quot;">​</a></h3><p>eventlet should not be run as root because it would cause your application code to run as root, which is not secure. However, this means it will not be possible to bind to port 80 or 443. Instead, a reverse proxy such as <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/nginx/" target="_blank" rel="noreferrer">nginx</a> or <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/apache-httpd/" target="_blank" rel="noreferrer">Apache httpd</a> should be used in front of eventlet.</p><p>You can bind to all external IPs on a non-privileged port by using <code>0.0.0.0</code> in the server arguments shown in the previous section. Don’t do this when using a reverse proxy setup, otherwise it will be possible to bypass the proxy.</p><p><code>0.0.0.0</code> is not a valid address to navigate to, you’d use a specific IP address in your browser.</p><h2 id="asgi" tabindex="-1">ASGI <a class="header-anchor" href="#asgi" aria-label="Permalink to &quot;ASGI {#asgi}&quot;">​</a></h2><p>If you’d like to use an ASGI server you will need to utilise WSGI to ASGI middleware. The asgiref <a href="https://github.com/django/asgiref#wsgi-to-asgi-adapter" target="_blank" rel="noreferrer">WsgiToAsgi</a> adapter is recommended as it integrates with the event loop used for Flask’s <a href="https://flask.palletsprojects.com/en/2.3.x/async-await/#async-await" target="_blank" rel="noreferrer">Using async and await</a> support. You can use the adapter by wrapping the Flask app,</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> asgiref</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">wsgi </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> WsgiToAsgi</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> flask </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Flask</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Flask</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">asgi_app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">WsgiToAsgi</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">app</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>and then serving the <code>asgi_app</code> with the ASGI server, e.g. using <a href="https://gitlab.com/pgjones/hypercorn" target="_blank" rel="noreferrer">Hypercorn</a>,</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hypercorn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">module:asgi_app</span></span></code></pre></div><h2 id="tell-flask-it-is-behind-a-proxy" tabindex="-1">Tell Flask it is Behind a Proxy <a class="header-anchor" href="#tell-flask-it-is-behind-a-proxy" aria-label="Permalink to &quot;Tell Flask it is Behind a Proxy {#tell-flask-it-is-behind-a-proxy}&quot;">​</a></h2><p>When using a reverse proxy, or many Python hosting platforms, the proxy will intercept and forward all external requests to the local WSGI server.</p><p>From the WSGI server and Flask application’s perspectives, requests are now coming from the HTTP server to the local address, rather than from the remote address to the external server address.</p><p>HTTP servers should set <code>X-Forwarded-</code> headers to pass on the real values to the application. The application can then be told to trust and use those values by wrapping it with the <a href="https://werkzeug.palletsprojects.com/en/2.3.x/middleware/proxy_fix/" target="_blank" rel="noreferrer">X-Forwarded-For Proxy Fix</a> middleware provided by Werkzeug.</p><p>This middleware should only be used if the application is actually behind a proxy, and should be configured with the number of proxies that are chained in front of it. Not all proxies set all the headers. Since incoming headers can be faked, you must set how many proxies are setting each header so the middleware knows what to trust.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> werkzeug</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">proxy_fix </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ProxyFix</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">wsgi_app</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ProxyFix</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    app</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">wsgi_app</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x_for</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x_proto</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x_host</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">x_prefix</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span></code></pre></div><p>Remember, only apply this middleware if you are behind a proxy, and set the correct number of proxies that set each header. It can be a security issue if you get this configuration wrong.</p><h2 id="nginx" tabindex="-1">nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to &quot;nginx {#nginx}&quot;">​</a></h2><p><a href="https://nginx.org/" target="_blank" rel="noreferrer">nginx</a> is a fast, production level HTTP server. When serving your application with one of the WSGI servers listed in <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/" target="_blank" rel="noreferrer">Deploying to Production</a>, it is often good or necessary to put a dedicated HTTP server in front of it. This “reverse proxy” can handle incoming requests, TLS, and other security and performance concerns better than the WSGI server.</p><p>Nginx can be installed using your system package manager, or a pre-built executable for Windows. Installing and running Nginx itself is outside the scope of this doc. This page outlines the basics of configuring Nginx to proxy your application. Be sure to read its documentation to understand what features are available.</p><h3 id="domain-name" tabindex="-1">Domain Name <a class="header-anchor" href="#domain-name" aria-label="Permalink to &quot;Domain Name {#domain-name}&quot;">​</a></h3><p>Acquiring and configuring a domain name is outside the scope of this doc. In general, you will buy a domain name from a registrar, pay for server space with a hosting provider, and then point your registrar at the hosting provider’s name servers.</p><p>To simulate this, you can also edit your <code>hosts</code> file, located at <code>/etc/hosts</code> on Linux. Add a line that associates a name with the local IP.</p><p>Modern Linux systems may be configured to treat any domain name that ends with <code>.localhost</code> like this without adding it to the hosts file.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># /etc/hosts</span></span>
<span class="line"><span style="color:#FFCB6B;">127.0.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello.localhost</span></span></code></pre></div><p>Configuration The nginx configuration is located at <code>/etc/nginx/nginx.conf</code> on Linux. It may be different depending on your operating system. Check the docs and look for <code>nginx.conf</code>.</p><p>Remove or comment out any existing <code>server</code> section. Add a <code>server</code> section and use the <code>proxy_pass</code> directive to point to the address the WSGI server is listening on. We’ll assume the WSGI server is listening locally at <code>http://127.0.0.1:8000</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># /etc/nginx.conf</span></span>
<span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">server_name</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">_</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">proxy_pass</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1:8000/</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">proxy_set_header</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">X-Forwarded-For</span><span style="color:#A6ACCD;"> $proxy_add_x_forwarded_for</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">proxy_set_header</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">X-Forwarded-Proto</span><span style="color:#A6ACCD;"> $scheme</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">proxy_set_header</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">X-Forwarded-Host</span><span style="color:#A6ACCD;"> $host</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">proxy_set_header</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">X-Forwarded-Prefix</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>Then <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/proxy_fix/" target="_blank" rel="noreferrer">Tell Flask it is Behind a Proxy</a> so that your application uses these headers.</p><h2 id="apache-httpd" tabindex="-1">Apache httpd <a class="header-anchor" href="#apache-httpd" aria-label="Permalink to &quot;Apache httpd {#apache-httpd}&quot;">​</a></h2><p><a href="https://httpd.apache.org/" target="_blank" rel="noreferrer">Apache httpd</a> is a fast, production level HTTP server. When serving your application with one of the WSGI servers listed in <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/" target="_blank" rel="noreferrer">Deploying to Production</a>, it is often good or necessary to put a dedicated HTTP server in front of it. This “reverse proxy” can handle incoming requests, TLS, and other security and performance concerns better than the WSGI server.</p><p>httpd can be installed using your system package manager, or a pre-built executable for Windows. Installing and running httpd itself is outside the scope of this doc. This page outlines the basics of configuring httpd to proxy your application. Be sure to read its documentation to understand what features are available.</p><h3 id="domain-name-1" tabindex="-1">Domain Name <a class="header-anchor" href="#domain-name-1" aria-label="Permalink to &quot;Domain Name {#domain-name-1}&quot;">​</a></h3><p>Acquiring and configuring a domain name is outside the scope of this doc. In general, you will buy a domain name from a registrar, pay for server space with a hosting provider, and then point your registrar at the hosting provider’s name servers.</p><p>To simulate this, you can also edit your <code>hosts</code> file, located at <code>/etc/hosts</code> on Linux. Add a line that associates a name with the local IP.</p><p>Modern Linux systems may be configured to treat any domain name that ends with <code>.localhost</code> like this without adding it to the hosts file.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># /etc/hosts</span></span>
<span class="line"><span style="color:#FFCB6B;">127.0.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hello.localhost</span></span></code></pre></div><h3 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration {#configuration}&quot;">​</a></h3><p>The httpd configuration is located at <code>/etc/httpd/conf/httpd.conf</code> on Linux. It may be different depending on your operating system. Check the docs and look for <code>httpd.conf</code>.</p><p>Remove or comment out any existing <code>DocumentRoot</code> directive. Add the config lines below. We’ll assume the WSGI server is listening locally at <code>http://127.0.0.1:8000</code>.</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/etc/httpd/conf/httpd.conf</span></span>
<span class="line"><span style="color:#FFCB6B;">LoadModule</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">proxy_module</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">modules/mod_proxy.so</span></span>
<span class="line"><span style="color:#FFCB6B;">LoadModule</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">proxy_http_module</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">modules/mod_proxy_http.so</span></span>
<span class="line"><span style="color:#FFCB6B;">ProxyPass</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1:8000/</span></span>
<span class="line"><span style="color:#FFCB6B;">RequestHeader</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">X-Forwarded-Proto</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http</span></span>
<span class="line"><span style="color:#FFCB6B;">RequestHeader</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">X-Forwarded-Prefix</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span></span></code></pre></div><p>The <code>LoadModule</code> lines might already exist. If so, make sure they are uncommented instead of adding them manually.</p><p>Then <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/proxy_fix/" target="_blank" rel="noreferrer">Tell Flask it is Behind a Proxy</a> so that your application uses the <code>X-Forwarded</code> headers. <code>X-Forwarded-For</code> and <code>X-Forwarded-Host</code> are automatically set by <code>ProxyPass</code>.</p>`,175),t=[l];function p(r,c,i,y,C,d){return a(),e("div",null,t)}const u=s(o,[["render",p]]);export{D as __pageData,u as default};
