import{_ as e,o as a,c as s,Q as t}from"./chunks/framework.01af844e.js";const b=JSON.parse('{"title":"Kubernetes Object Management","description":"","frontmatter":{},"headers":[],"relativePath":"golang/k8s/concept/overview/object_k8s/k8s_object_manage.md","filePath":"golang/k8s/concept/overview/object_k8s/k8s_object_manage.md","lastUpdated":1693758126000}'),o={name:"golang/k8s/concept/overview/object_k8s/k8s_object_manage.md"},n=t(`<h1 id="kubernetes-object-management" tabindex="-1">Kubernetes Object Management <a class="header-anchor" href="#kubernetes-object-management" aria-label="Permalink to &quot;Kubernetes Object Management&quot;">​</a></h1><p>The <code>kubectl</code> command-line tool supports several different ways to create and manage Kubernetes <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/#kubernetes-objects" target="_blank" rel="noreferrer">objects</a>. This document provides an overview of the different approaches. Read the <a href="https://kubectl.docs.kubernetes.io/" target="_blank" rel="noreferrer">Kubectl book</a> for details of managing objects by Kubectl.</p><h2 id="management-techniques" tabindex="-1">Management techniques <a class="header-anchor" href="#management-techniques" aria-label="Permalink to &quot;Management techniques&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">Warning:</p><p>A Kubernetes object should be managed using only one technique. Mixing and matching techniques for the same object results in undefined behavior.</p></div><table><thead><tr><th>Management technique</th><th>Operates on</th><th>Recommended environment</th><th>Supported writers</th><th>Learning curve</th></tr></thead><tbody><tr><td>Imperative commands</td><td>Live objects</td><td>Development projects</td><td>1+</td><td>Lowest</td></tr><tr><td>Imperative object configuration</td><td>Individual files</td><td>Production projects</td><td>1</td><td>Moderate</td></tr><tr><td>Declarative object configuration</td><td>Directories of files</td><td>Production projects</td><td>1+</td><td>Highest</td></tr></tbody></table><h2 id="imperative-commands" tabindex="-1">Imperative commands <a class="header-anchor" href="#imperative-commands" aria-label="Permalink to &quot;Imperative commands&quot;">​</a></h2><p>When using imperative commands, a user operates directly on live objects in a cluster. The user provides operations to the <code>kubectl</code> command as arguments or flags.</p><p>This is the recommended way to get started or to run a one-off task in a cluster. Because this technique operates directly on live objects, it provides no history of previous configurations.</p><h3 id="examples" tabindex="-1">Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;Examples&quot;">​</a></h3><p>Run an instance of the nginx container by creating a Deployment object:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span></span></code></pre></div><h3 id="trade-offs" tabindex="-1">Trade-offs <a class="header-anchor" href="#trade-offs" aria-label="Permalink to &quot;Trade-offs&quot;">​</a></h3><p>Advantages compared to object configuration:</p><ul><li>Commands are expressed as a single action word.</li><li>Commands require only a single step to make changes to the cluster.</li></ul><p>Disadvantages compared to object configuration:</p><ul><li>Commands do not integrate with change review processes.</li><li>Commands do not provide an audit trail associated with changes.</li><li>Commands do not provide a source of records except for what is live.</li><li>Commands do not provide a template for creating new objects.</li></ul><h2 id="imperative-object-configuration" tabindex="-1">Imperative object configuration <a class="header-anchor" href="#imperative-object-configuration" aria-label="Permalink to &quot;Imperative object configuration&quot;">​</a></h2><p>In imperative object configuration, the kubectl command specifies the operation (create, replace, etc.), optional flags and at least one file name. The file specified must contain a full definition of the object in YAML or JSON format.</p><p>See the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/" target="_blank" rel="noreferrer">API reference</a> for more details on object definitions.</p><div class="warning custom-block"><p class="custom-block-title">Warning:</p><p>The imperative replace command <code>replaces</code> the existing spec with the newly provided one, dropping all changes to the object missing from the configuration file. This approach should not be used with resource types whose specs are updated independently of the configuration file. Services of type <code>LoadBalancer</code>, for example, have their <code>externalIPs</code> field updated independently from the configuration by the cluster.</p></div><h3 id="examples-1" tabindex="-1">Examples <a class="header-anchor" href="#examples-1" aria-label="Permalink to &quot;Examples&quot;">​</a></h3><p>Create the objects defined in a configuration file:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx.yaml</span></span></code></pre></div><p>Delete the objects defined in two configuration files:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx.yaml</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">redis.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx.yaml</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">redis.yaml</span></span></code></pre></div><p>Update the objects defined in a configuration file by overwriting the live configuration:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">replace</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">replace</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx.yaml</span></span></code></pre></div><h3 id="trade-offs-1" tabindex="-1">Trade-offs <a class="header-anchor" href="#trade-offs-1" aria-label="Permalink to &quot;Trade-offs&quot;">​</a></h3><p>Advantages compared to imperative commands:</p><ul><li>Object configuration can be stored in a source control system such as Git.</li><li>Object configuration can integrate with processes such as reviewing changes before push and audit trails.</li><li>Object configuration provides a template for creating new objects.</li></ul><p>Disadvantages compared to imperative commands:</p><ul><li>Object configuration requires basic understanding of the object schema.</li><li>Object configuration requires the additional step of writing a YAML file.</li></ul><p>Advantages compared to declarative object configuration:</p><ul><li>Imperative object configuration behavior is simpler and easier to understand.</li><li>As of Kubernetes version 1.5, imperative object configuration is more mature.</li></ul><p>Disadvantages compared to declarative object configuration:</p><ul><li>Imperative object configuration works best on files, not directories.</li><li>Updates to live objects must be reflected in configuration files, or they will be lost during the next replacement.</li></ul><h2 id="declarative-object-configuration" tabindex="-1">Declarative object configuration <a class="header-anchor" href="#declarative-object-configuration" aria-label="Permalink to &quot;Declarative object configuration&quot;">​</a></h2><p>When using declarative object configuration, a user operates on object configuration files stored locally, however the user does not define the operations to be taken on the files. Create, update, and delete operations are automatically detected per-object by <code>kubectl</code>. This enables working on directories, where different operations might be needed for different objects.</p><div class="tip custom-block"><p class="custom-block-title">Note:</p><p>Declarative object configuration retains changes made by other writers, even if the changes are not merged back to the object configuration file. This is possible by using the patch API operation to write only observed differences, instead of using the replace API operation to replace the entire object configuration.</p></div><h3 id="examples-2" tabindex="-1">Examples <a class="header-anchor" href="#examples-2" aria-label="Permalink to &quot;Examples&quot;">​</a></h3><p>Process all object configuration files in the <code>configs</code> directory, and create or patch the live objects. You can first diff to see what changes are going to be made, and then apply:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">diff</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">configs/</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">configs/</span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">diff</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">configs/</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">configs/</span></span></code></pre></div><p>Recursively process directories:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">diff</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">configs/</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">configs/</span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">diff</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">configs/</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">configs/</span></span></code></pre></div><h3 id="trade-offs-2" tabindex="-1">Trade-offs <a class="header-anchor" href="#trade-offs-2" aria-label="Permalink to &quot;Trade-offs&quot;">​</a></h3><p>Advantages compared to imperative object configuration:</p><ul><li>Changes made directly to live objects are retained, even if they are not merged back into the configuration files.</li><li>Declarative object configuration has better support for operating on directories and automatically detecting operation types (create, patch, delete) per-object.</li></ul><p>Disadvantages compared to imperative object configuration:</p><ul><li>Declarative object configuration is harder to debug and understand results when they are unexpected.</li><li>Partial updates using diffs create complex merge and patch operations.</li></ul><h2 id="what-s-next" tabindex="-1">What&#39;s next <a class="header-anchor" href="#what-s-next" aria-label="Permalink to &quot;What&#39;s next&quot;">​</a></h2><ul><li><a href="https://kubernetes.io/docs/tasks/manage-kubernetes-objects/imperative-command/" target="_blank" rel="noreferrer">Managing Kubernetes Objects Using Imperative Commands</a></li><li><a href="https://kubernetes.io/docs/tasks/manage-kubernetes-objects/imperative-config/" target="_blank" rel="noreferrer">Imperative Management of Kubernetes Objects Using Configuration Files</a></li><li><a href="https://kubernetes.io/docs/tasks/manage-kubernetes-objects/declarative-config/" target="_blank" rel="noreferrer">Declarative Management of Kubernetes Objects Using Configuration Files</a></li><li><a href="https://kubernetes.io/docs/tasks/manage-kubernetes-objects/kustomization/" target="_blank" rel="noreferrer">Declarative Management of Kubernetes Objects Using Kustomize</a></li><li><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands/" target="_blank" rel="noreferrer">Kubectl Command Reference</a></li><li><a href="https://kubectl.docs.kubernetes.io/" target="_blank" rel="noreferrer">Kubectl Book</a></li><li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/" target="_blank" rel="noreferrer">Kubernetes API Reference</a></li></ul>`,51),l=[n];function r(i,c,p,d,h,u){return a(),s("div",null,l)}const g=e(o,[["render",r]]);export{b as __pageData,g as default};
