import{_ as e,o as s,c as a,Q as n}from"./chunks/framework.01af844e.js";const y=JSON.parse('{"title":"Namespaces","description":"","frontmatter":{},"headers":[],"relativePath":"container/k8s/concept/overview/object_k8s/namespace.md","filePath":"container/k8s/concept/overview/object_k8s/namespace.md","lastUpdated":1694607182000}'),t={name:"container/k8s/concept/overview/object_k8s/namespace.md"},o=n(`<h1 id="namespaces" tabindex="-1">Namespaces <a class="header-anchor" href="#namespaces" aria-label="Permalink to &quot;Namespaces&quot;">​</a></h1><p>In Kubernetes, namespaces provides a mechanism for isolating groups of resources within a single cluster. Names of resources need to be unique within a namespace, but not across namespaces. Namespace-based scoping is applicable only for namespaced objects (e.g. Deployments, Services, etc) and not for cluster-wide objects (e.g. StorageClass, Nodes, PersistentVolumes, etc).</p><h2 id="when-to-use-multiple-namespaces" tabindex="-1">When to Use Multiple Namespaces <a class="header-anchor" href="#when-to-use-multiple-namespaces" aria-label="Permalink to &quot;When to Use Multiple Namespaces&quot;">​</a></h2><p>Namespaces are intended for use in environments with many users spread across multiple teams, or projects. For clusters with a few to tens of users, you should not need to create or think about namespaces at all. Start using namespaces when you need the features they provide.</p><p>Namespaces provide a scope for names. Names of resources need to be unique within a namespace, but not across namespaces. Namespaces cannot be nested inside one another and each Kubernetes resource can only be in one namespace.</p><p>Namespaces are a way to divide cluster resources between multiple users (via <a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/" target="_blank" rel="noreferrer">resource quota</a>).</p><p>It is not necessary to use multiple namespaces to separate slightly different resources, such as different versions of the same software: use <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels" target="_blank" rel="noreferrer">labels</a> to distinguish resources within the same namespace.</p><div class="tip custom-block"><p class="custom-block-title">Note:</p><p>For a production cluster, consider not using the <code>default</code> namespace. Instead, make other namespaces and use those.</p></div><h2 id="initial-namespaces" tabindex="-1">Initial namespaces <a class="header-anchor" href="#initial-namespaces" aria-label="Permalink to &quot;Initial namespaces&quot;">​</a></h2><p>Kubernetes starts with four initial namespaces:</p><ul><li><p><code>default</code>: Kubernetes includes this namespace so that you can start using your new cluster without first creating a namespace.</p></li><li><p><code>kube-node-lease</code>: This namespace holds <a href="https://kubernetes.io/docs/concepts/architecture/leases/" target="_blank" rel="noreferrer">Lease</a> objects associated with each node. Node leases allow the kubelet to send <a href="https://kubernetes.io/docs/concepts/architecture/nodes/#heartbeats" target="_blank" rel="noreferrer">heartbeats</a> so that the control plane can detect node failure.</p></li><li><p><code>kube-public</code>: This namespace is readable by all clients (including those not authenticated). This namespace is mostly reserved for cluster usage, in case that some resources should be visible and readable publicly throughout the whole cluster. The public aspect of this namespace is only a convention, not a requirement.</p></li><li><p><code>kube-system</code>: The namespace for objects created by the Kubernetes system.</p></li></ul><h2 id="working-with-namespaces" tabindex="-1">Working with Namespaces <a class="header-anchor" href="#working-with-namespaces" aria-label="Permalink to &quot;Working with Namespaces&quot;">​</a></h2><p>Creation and deletion of namespaces are described in the <a href="https://kubernetes.io/docs/tasks/administer-cluster/namespaces" target="_blank" rel="noreferrer">Admin Guide documentation for namespaces</a>.</p><div class="tip custom-block"><p class="custom-block-title">Note:</p><p>Avoid creating namespaces with the prefix <code>kube-</code>, since it is reserved for Kubernetes system namespaces.</p></div><h3 id="viewing-namespaces" tabindex="-1">Viewing namespaces <a class="header-anchor" href="#viewing-namespaces" aria-label="Permalink to &quot;Viewing namespaces&quot;">​</a></h3><p>You can list the current namespaces in a cluster using:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">namespace</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">namespace</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">NAME              STATUS   AGE</span></span>
<span class="line"><span style="color:#e1e4e8;">default           Active   1d</span></span>
<span class="line"><span style="color:#e1e4e8;">kube-node-lease   Active   1d</span></span>
<span class="line"><span style="color:#e1e4e8;">kube-public       Active   1d</span></span>
<span class="line"><span style="color:#e1e4e8;">kube-system       Active   1d</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">NAME              STATUS   AGE</span></span>
<span class="line"><span style="color:#24292e;">default           Active   1d</span></span>
<span class="line"><span style="color:#24292e;">kube-node-lease   Active   1d</span></span>
<span class="line"><span style="color:#24292e;">kube-public       Active   1d</span></span>
<span class="line"><span style="color:#24292e;">kube-system       Active   1d</span></span></code></pre></div><h3 id="setting-the-namespace-for-a-request" tabindex="-1">Setting the namespace for a request <a class="header-anchor" href="#setting-the-namespace-for-a-request" aria-label="Permalink to &quot;Setting the namespace for a request&quot;">​</a></h3><p>To set the namespace for a current request, use the <code>--namespace</code> flag.</p><p>For example:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--image=nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespace=</span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">insert-namespace-name-here</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pods</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespace=</span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">insert-namespace-name-here</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--image=nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespace=</span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">insert-namespace-name-here</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pods</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespace=</span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">insert-namespace-name-here</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h3 id="setting-the-namespace-preference" tabindex="-1">Setting the namespace preference <a class="header-anchor" href="#setting-the-namespace-preference" aria-label="Permalink to &quot;Setting the namespace preference&quot;">​</a></h3><p>You can permanently save the namespace for all subsequent kubectl commands in that context.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set-context</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--current</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespace=</span><span style="color:#F97583;">&lt;</span><span style="color:#79B8FF;">insert-namespace-name-here</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;"># Validate it</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">view</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--minify</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">namespace:</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set-context</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--current</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespace=</span><span style="color:#D73A49;">&lt;</span><span style="color:#005CC5;">insert-namespace-name-here</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;"># Validate it</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">view</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--minify</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">namespace:</span></span></code></pre></div><h2 id="namespaces-and-dns" tabindex="-1">Namespaces and DNS <a class="header-anchor" href="#namespaces-and-dns" aria-label="Permalink to &quot;Namespaces and DNS&quot;">​</a></h2><p>When you create a <a href="https://kubernetes.io/docs/concepts/services-networking/service/" target="_blank" rel="noreferrer">Service</a>, it creates a corresponding <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/" target="_blank" rel="noreferrer">DNS entry</a>. This entry is of the form <code>&lt;service-name&gt;.&lt;namespace-name&gt;.svc.cluster.local</code>, which means that if a container only uses <code>&lt;service-name&gt;</code>, it will resolve to the service which is local to a namespace. This is useful for using the same configuration across multiple namespaces such as Development, Staging and Production. If you want to reach across namespaces, you need to use the fully qualified domain name (FQDN).</p><p>As a result, all namespace names must be valid <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#dns-label-names" target="_blank" rel="noreferrer">RFC 1123 DNS labels</a>.</p><div class="warning custom-block"><p class="custom-block-title">Warning:</p><p>By creating namespaces with the same name as <a href="https://data.iana.org/TLD/tlds-alpha-by-domain.txt" target="_blank" rel="noreferrer">public top-level domains</a>, Services in these namespaces can have short DNS names that overlap with public DNS records. Workloads from any namespace performing a DNS lookup without a <a href="https://datatracker.ietf.org/doc/html/rfc1034#page-8" target="_blank" rel="noreferrer">trailing dot</a> will be redirected to those services, taking precedence over public DNS.</p><p>To mitigate this, limit privileges for creating namespaces to trusted users. If required, you could additionally configure third-party security controls, such as <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/" target="_blank" rel="noreferrer">admission webhooks</a>, to block creating any namespace with the name of <a href="https://data.iana.org/TLD/tlds-alpha-by-domain.txt" target="_blank" rel="noreferrer">public TLDs</a>.</p></div><h2 id="not-all-objects-are-in-a-namespace" tabindex="-1">Not all objects are in a namespace <a class="header-anchor" href="#not-all-objects-are-in-a-namespace" aria-label="Permalink to &quot;Not all objects are in a namespace&quot;">​</a></h2><p>Most Kubernetes resources (e.g. pods, services, replication controllers, and others) are in some namespaces. However namespace resources are not themselves in a namespace. And low-level resources, such as <a href="https://kubernetes.io/docs/concepts/architecture/nodes/" target="_blank" rel="noreferrer">nodes</a> and <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/" target="_blank" rel="noreferrer">persistentVolumes</a>, are not in any namespace.</p><p>To see which Kubernetes resources are and aren&#39;t in a namespace:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># In a namespace</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">api-resources</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespaced=true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Not in a namespace</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">api-resources</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespaced=false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># In a namespace</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">api-resources</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespaced=true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Not in a namespace</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">api-resources</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespaced=false</span></span></code></pre></div><h2 id="automatic-labelling" tabindex="-1">Automatic labelling <a class="header-anchor" href="#automatic-labelling" aria-label="Permalink to &quot;Automatic labelling&quot;">​</a></h2><p><em>FEATURE STATE</em>: <code>Kubernetes 1.22 [stable]</code></p><p>The Kubernetes control plane sets an immutable label <code>kubernetes.io/metadata.name</code> on all namespaces. The value of the label is the namespace name.</p><h2 id="what-s-next" tabindex="-1">What&#39;s next <a class="header-anchor" href="#what-s-next" aria-label="Permalink to &quot;What&#39;s next&quot;">​</a></h2><p>Learn more about <a href="https://kubernetes.io/docs/tasks/administer-cluster/namespaces/#creating-a-new-namespace" target="_blank" rel="noreferrer">creating a new namespace</a>. Learn more about <a href="https://kubernetes.io/docs/tasks/administer-cluster/namespaces/#deleting-a-namespace" target="_blank" rel="noreferrer">deleting a namespace</a>.</p>`,38),l=[o];function p(c,r,i,d,h,u){return s(),a("div",null,l)}const b=e(t,[["render",p]]);export{y as __pageData,b as default};
