import{_ as s,o as a,c as e,V as n}from"./chunks/framework.48c56699.js";const d=JSON.parse('{"title":"Modular Applications with Blueprints","description":"","frontmatter":{},"headers":[],"relativePath":"python/flask/user_guide/blueprint.md","filePath":"python/flask/user_guide/blueprint.md","lastUpdated":1691455424000}'),l={name:"python/flask/user_guide/blueprint.md"},o=n(`<h1 id="modular-applications-with-blueprints" tabindex="-1">Modular Applications with Blueprints <a class="header-anchor" href="#modular-applications-with-blueprints" aria-label="Permalink to &quot;Modular Applications with Blueprints&quot;">​</a></h1><details class="details custom-block"><summary>Changelog</summary><p><em>New in version 0.7.</em></p></details><p>Flask uses a concept of <code>blueprints</code> for making application components and supporting common patterns within an application or across applications. Blueprints can greatly simplify how large applications work and provide a central means for Flask extensions to register operations on applications. A <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Blueprint" target="_blank" rel="noreferrer">Blueprint</a> object works similarly to a <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Flask" target="_blank" rel="noreferrer">Flask</a> application object, but it is not actually an application. Rather it is a blueprint of how to construct or extend an application.</p><h2 id="why-blueprints" tabindex="-1">Why Blueprints? <a class="header-anchor" href="#why-blueprints" aria-label="Permalink to &quot;Why Blueprints?&quot;">​</a></h2><p>Blueprints in Flask are intended for these cases:</p><ul><li><p>Factor an application into a set of blueprints. This is ideal for larger applications; a project could instantiate an application object, initialize several extensions, and register a collection of blueprints.</p></li><li><p>Register a blueprint on an application at a URL prefix and/or subdomain. Parameters in the URL prefix/subdomain become common view arguments (with defaults) across all view functions in the blueprint.</p></li><li><p>Register a blueprint multiple times on an application with different URL rules.</p></li><li><p>Provide template filters, static files, templates, and other utilities through blueprints. A blueprint does not have to implement applications or view functions.</p></li><li><p>Register a blueprint on an application for any of these cases when initializing a Flask extension.</p></li></ul><p>A blueprint in Flask is not a pluggable app because it is not actually an application – it’s a set of operations which can be registered on an application, even multiple times. Why not have multiple application objects? You can do that (see <a href="https://flask.palletsprojects.com/en/2.3.x/patterns/appdispatch/" target="_blank" rel="noreferrer">Application Dispatching</a>), but your applications will have separate configs and will be managed at the WSGI layer.</p><p>Blueprints instead provide separation at the Flask level, share application config, and can change an application object as necessary with being registered. The downside is that you cannot unregister a blueprint once an application was created without having to destroy the whole application object.</p><h2 id="the-concept-of-blueprints" tabindex="-1">The Concept of Blueprints <a class="header-anchor" href="#the-concept-of-blueprints" aria-label="Permalink to &quot;The Concept of Blueprints&quot;">​</a></h2><p>The basic concept of blueprints is that they record operations to execute when registered on an application. Flask associates view functions with blueprints when dispatching requests and generating URLs from one endpoint to another.</p><h2 id="my-first-blueprint" tabindex="-1">My First Blueprint <a class="header-anchor" href="#my-first-blueprint" aria-label="Permalink to &quot;My First Blueprint&quot;">​</a></h2><p>This is what a very basic blueprint looks like. In this case we want to implement a blueprint that does simple rendering of static templates:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> flask </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Blueprint</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> render_template</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> abort</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> jinja2 </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> TemplateNotFound</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">simple_page </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">simple_page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                        </span><span style="color:#A6ACCD;font-style:italic;">template_folder</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">templates</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">route</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">defaults</span><span style="color:#89DDFF;">={</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">index</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">})</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">route</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/&lt;page&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">show</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">page</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">render_template</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&#39;pages/</span><span style="color:#F78C6C;">{</span><span style="color:#82AAFF;">page</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">.html&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">except</span><span style="color:#A6ACCD;"> TemplateNotFound</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">abort</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">404</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>When you bind a function with the help of the <code>@simple_page.route</code> decorator, the blueprint will record the intention of registering the function <code>show</code> on the application when it’s later registered. Additionally it will prefix the endpoint of the function with the name of the blueprint which was given to the <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Blueprint" target="_blank" rel="noreferrer">Blueprint</a> constructor (in this case also <code>simple_page</code>). The blueprint’s name does not modify the URL, only the endpoint.</p><h2 id="registering-blueprints" tabindex="-1">Registering Blueprints <a class="header-anchor" href="#registering-blueprints" aria-label="Permalink to &quot;Registering Blueprints&quot;">​</a></h2><p>So how do you register that blueprint? Like this:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> flask </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Flask</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> yourapplication</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">simple_page </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> simple_page</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Flask</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">simple_page</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>If you check the rules registered on the application, you will find these:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&gt;&gt;&gt;</span><span style="color:#A6ACCD;"> app</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">url_map</span></span>
<span class="line"><span style="color:#82AAFF;">Map</span><span style="color:#89DDFF;">([&lt;</span><span style="color:#82AAFF;">Rule </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/static/&lt;filename&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">HEAD</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> OPTIONS</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> -&gt; static</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;">Rule </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/&lt;page&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">HEAD</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> OPTIONS</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> -&gt; simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">show</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;">Rule </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">HEAD</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> OPTIONS</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> -&gt; simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">show</span><span style="color:#89DDFF;">&gt;])</span></span></code></pre></div><p>The first one is obviously from the application itself for the static files. The other two are for the show function of the <code>simple_page</code> blueprint. As you can see, they are also prefixed with the name of the blueprint and separated by a dot (.).</p><p>Blueprints however can also be mounted at different locations:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">simple_page</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">url_prefix</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/pages</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>And sure enough, these are the generated rules:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&gt;&gt;&gt;</span><span style="color:#A6ACCD;"> app</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">url_map</span></span>
<span class="line"><span style="color:#82AAFF;">Map</span><span style="color:#89DDFF;">([&lt;</span><span style="color:#82AAFF;">Rule </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/static/&lt;filename&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">HEAD</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> OPTIONS</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> -&gt; static</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;">Rule </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/pages/&lt;page&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">HEAD</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> OPTIONS</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> -&gt; simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">show</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;">Rule </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/pages/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">HEAD</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> OPTIONS</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> -&gt; simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">show</span><span style="color:#89DDFF;">&gt;])</span></span></code></pre></div><p>On top of that you can register blueprints multiple times though not every blueprint might respond properly to that. In fact it depends on how the blueprint is implemented if it can be mounted more than once.</p><h2 id="nesting-blueprints" tabindex="-1">Nesting Blueprints <a class="header-anchor" href="#nesting-blueprints" aria-label="Permalink to &quot;Nesting Blueprints&quot;">​</a></h2><p>It is possible to register a blueprint on another blueprint.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">parent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">url_prefix</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/parent</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">child </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">child</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">url_prefix</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/child</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">parent</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">child</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">parent</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>The child blueprint will gain the parent’s name as a prefix to its name, and child URLs will be prefixed with the parent’s URL prefix.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">url_for</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent.child.create</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">parent</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">child</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">create</span></span></code></pre></div><p>In addition a child blueprint’s will gain their parent’s subdomain, with their subdomain as prefix if present i.e.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">parent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">subdomain</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">child </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">child</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">subdomain</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">child</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">parent</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">child</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">parent</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">url_for</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent.child.create</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">_external</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;</span><span style="color:#676E95;font-style:italic;">child.parent.domain.tld</span><span style="color:#89DDFF;font-style:italic;">&quot;</span></span></code></pre></div><p>Blueprint-specific before request functions, etc. registered with the parent will trigger for the child. If a child does not have an error handler that can handle a given exception, the parent’s will be tried.</p><h2 id="blueprint-resources" tabindex="-1">Blueprint Resources <a class="header-anchor" href="#blueprint-resources" aria-label="Permalink to &quot;Blueprint Resources&quot;">​</a></h2><p>Blueprints can provide resources as well. Sometimes you might want to introduce a blueprint only for the resources it provides.</p><h3 id="blueprint-resource-folder" tabindex="-1">Blueprint Resource Folder <a class="header-anchor" href="#blueprint-resource-folder" aria-label="Permalink to &quot;Blueprint Resource Folder&quot;">​</a></h3><p>Like for regular applications, blueprints are considered to be contained in a folder. While multiple blueprints can originate from the same folder, it does not have to be the case and it’s usually not recommended.</p><p>The folder is inferred from the second argument to <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Blueprint" target="_blank" rel="noreferrer">Blueprint</a> which is usually <code>__name__</code>. This argument specifies what logical Python module or package corresponds to the blueprint. If it points to an actual Python package that package (which is a folder on the filesystem) is the resource folder. If it’s a module, the package the module is contained in will be the resource folder. You can access the <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Blueprint.root_path" target="_blank" rel="noreferrer">Blueprint.root_path</a> property to see what the resource folder is:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&gt;&gt;&gt;</span><span style="color:#A6ACCD;"> simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">root_path</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&#39;</span><span style="color:#676E95;font-style:italic;">/Users/username/TestProject/yourapplication</span><span style="color:#89DDFF;font-style:italic;">&#39;</span></span></code></pre></div><p>To quickly open sources from this folder you can use the <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Blueprint.open_resource" target="_blank" rel="noreferrer">open_resource()</a> function:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">with</span><span style="color:#A6ACCD;"> simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open_resource</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">static/style.css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> f</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    code </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> f</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">()</span></span></code></pre></div><h3 id="static-files" tabindex="-1">Static Files <a class="header-anchor" href="#static-files" aria-label="Permalink to &quot;Static Files&quot;">​</a></h3><p>A blueprint can expose a folder with static files by providing the path to the folder on the filesystem with the <code>static_folder</code> argument. It is either an absolute path or relative to the blueprint’s location:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">admin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">static_folder</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">static</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>By default the rightmost part of the path is where it is exposed on the web. This can be changed with the <code>static_url_path</code> argument. Because the folder is called <code>static</code> here it will be available at the <code>url_prefix</code> of the blueprint + <code>/static</code>. If the blueprint has the prefix <code>/admin</code>, the static URL will be <code>/admin/static</code>.</p><p>The endpoint is named <code>blueprint_name.static</code>. You can generate URLs to it with <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.url_for" target="_blank" rel="noreferrer">url_for()</a> like you would with the static folder of the application:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">url_for</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">admin.static</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">filename</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">style.css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>However, if the blueprint does not have a <code>url_prefix</code>, it is not possible to access the blueprint’s static folder. This is because the URL would be <code>/static</code> in this case, and the application’s <code>/static</code> route takes precedence. Unlike template folders, blueprint static folders are not searched if the file does not exist in the application static folder.</p><h3 id="templates" tabindex="-1">Templates <a class="header-anchor" href="#templates" aria-label="Permalink to &quot;Templates&quot;">​</a></h3><p>If you want the blueprint to expose templates you can do that by providing the <code>template_folder</code> parameter to the Blueprint constructor:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">admin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blueprint</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">__name__</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">template_folder</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">templates</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>For static files, the path can be absolute or relative to the blueprint resource folder.</p><p>The template folder is added to the search path of templates but with a lower priority than the actual application’s template folder. That way you can easily override templates that a blueprint provides in the actual application. This also means that if you don’t want a blueprint template to be accidentally overridden, make sure that no other blueprint or actual application template has the same relative path. When multiple blueprints provide the same relative template path the first blueprint registered takes precedence over the others.</p><p>So if you have a blueprint in the folder <code>yourapplication/admin</code> and you want to render the template <code>&#39;admin/index.html&#39;</code> and you have provided templates as a template_folder you will have to create a file like this: <code>yourapplication/admin/templates/admin/index.html</code>. The reason for the extra admin folder is to avoid getting our template overridden by a template named <code>index.html</code> in the actual application template folder.</p><p>To further reiterate this: if you have a blueprint named admin and you want to render a template called <code>index.html</code> which is specific to this blueprint, the best idea is to lay out your templates like this:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yourpackage/</span></span>
<span class="line"><span style="color:#A6ACCD;">    blueprints/</span></span>
<span class="line"><span style="color:#A6ACCD;">        admin/</span></span>
<span class="line"><span style="color:#A6ACCD;">            templates/</span></span>
<span class="line"><span style="color:#A6ACCD;">                admin/</span></span>
<span class="line"><span style="color:#A6ACCD;">                    index.html</span></span>
<span class="line"><span style="color:#A6ACCD;">            __init__.py</span></span></code></pre></div><p>And then when you want to render the template, use <code>admin/index.html</code> as the name to look up the template by. If you encounter problems loading the correct templates enable the <code>EXPLAIN_TEMPLATE_LOADING</code> config variable which will instruct Flask to print out the steps it goes through to locate templates on every <code>render_template</code> call.</p><h2 id="building-urls" tabindex="-1">Building URLs <a class="header-anchor" href="#building-urls" aria-label="Permalink to &quot;Building URLs&quot;">​</a></h2><p>If you want to link from one page to another you can use the <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.url_for" target="_blank" rel="noreferrer">url_for()</a> function just like you normally would do just that you prefix the URL endpoint with the name of the blueprint and a dot (.):</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">url_for</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">admin.index</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>Additionally if you are in a view function of a blueprint or a rendered template and you want to link to another endpoint of the same blueprint, you can use relative redirects by prefixing the endpoint with a dot only:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">url_for</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.index</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>This will link to <code>admin.index</code> for instance in case the current request was dispatched to any other admin blueprint endpoint.</p><h2 id="blueprint-error-handlers" tabindex="-1">Blueprint Error Handlers <a class="header-anchor" href="#blueprint-error-handlers" aria-label="Permalink to &quot;Blueprint Error Handlers&quot;">​</a></h2><p>Blueprints support the <code>errorhandler</code> decorator just like the <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Flask" target="_blank" rel="noreferrer">Flask</a> application object, so it is easy to make Blueprint-specific custom error pages.</p><p>Here is an example for a “404 Page Not Found” exception:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">simple_page</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">errorhandler</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">404</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">page_not_found</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">render_template</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pages/404.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>Most errorhandlers will simply work as expected; however, there is a caveat concerning handlers for 404 and 405 exceptions. These errorhandlers are only invoked from an appropriate <code>raise</code> statement or a call to <code>abort</code> in another of the blueprint’s view functions; they are not invoked by, e.g., an invalid URL access. This is because the blueprint does not “own” a certain URL space, so the application instance has no way of knowing which blueprint error handler it should run if given an invalid URL. If you would like to execute different handling strategies for these errors based on URL prefixes, they may be defined at the application level using the <code>request</code> proxy object:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">errorhandler</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">404</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">errorhandler</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">405</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">_handle_api_error</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">ex</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> request</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startswith</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">jsonify</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">error</span><span style="color:#89DDFF;">=</span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ex</span><span style="color:#89DDFF;">)),</span><span style="color:#A6ACCD;"> ex</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">code</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> ex</span></span></code></pre></div><p>See <a href="https://flask.palletsprojects.com/en/2.3.x/errorhandling/" target="_blank" rel="noreferrer">Handling Application Errors</a>.</p>`,70),p=[o];function t(r,c,i,F,y,D){return a(),e("div",null,p)}const u=s(l,[["render",t]]);export{d as __pageData,u as default};
