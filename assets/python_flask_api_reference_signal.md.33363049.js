import{_ as s,o as a,c as n,Q as e}from"./chunks/framework.01af844e.js";const g=JSON.parse('{"title":"Signals","description":"","frontmatter":{},"headers":[],"relativePath":"python/flask/api_reference/signal.md","filePath":"python/flask/api_reference/signal.md","lastUpdated":1693404008000}'),p={name:"python/flask/api_reference/signal.md"},l=e(`<h1 id="signals" tabindex="-1">Signals <a class="header-anchor" href="#signals" aria-label="Permalink to &quot;Signals {#signals}&quot;">​</a></h1><p>Signals are provided by the Blinker library. See <a href="/python/flask/user_guide/signal#signals">Signals</a> for an introduction.</p><h2 id="flask-template-rendered" tabindex="-1">flask.template_rendered <a class="header-anchor" href="#flask-template-rendered" aria-label="Permalink to &quot;flask.template_rendered&quot;">​</a></h2><p>This signal is sent when a template was successfully rendered. The signal is invoked with the instance of the template as <code>template</code> and the context as dictionary (named <code>context</code>).</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">log_template_renders</span><span style="color:#E1E4E8;">(sender, template, context, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    sender.logger.debug(</span><span style="color:#9ECBFF;">&#39;Rendering template &quot;</span><span style="color:#79B8FF;">%s</span><span style="color:#9ECBFF;">&quot; with context </span><span style="color:#79B8FF;">%s</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        template.name </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;string template&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        context)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> template_rendered</span></span>
<span class="line"><span style="color:#E1E4E8;">template_rendered.connect(log_template_renders, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log_template_renders</span><span style="color:#24292E;">(sender, template, context, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    sender.logger.debug(</span><span style="color:#032F62;">&#39;Rendering template &quot;</span><span style="color:#005CC5;">%s</span><span style="color:#032F62;">&quot; with context </span><span style="color:#005CC5;">%s</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        template.name </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;string template&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        context)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> template_rendered</span></span>
<span class="line"><span style="color:#24292E;">template_rendered.connect(log_template_renders, app)</span></span></code></pre></div><h2 id="flask-before-render-template" tabindex="-1">flask.before_render_template <a class="header-anchor" href="#flask-before-render-template" aria-label="Permalink to &quot;flask.before_render_template&quot;">​</a></h2><p>This signal is sent before template rendering process. The signal is invoked with the instance of the template as <code>template</code> and the context as dictionary (named <code>context</code>).</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">log_template_renders</span><span style="color:#E1E4E8;">(sender, template, context, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    sender.logger.debug(</span><span style="color:#9ECBFF;">&#39;Rendering template &quot;</span><span style="color:#79B8FF;">%s</span><span style="color:#9ECBFF;">&quot; with context </span><span style="color:#79B8FF;">%s</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        template.name </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;string template&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                        context)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> before_render_template</span></span>
<span class="line"><span style="color:#E1E4E8;">before_render_template.connect(log_template_renders, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log_template_renders</span><span style="color:#24292E;">(sender, template, context, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    sender.logger.debug(</span><span style="color:#032F62;">&#39;Rendering template &quot;</span><span style="color:#005CC5;">%s</span><span style="color:#032F62;">&quot; with context </span><span style="color:#005CC5;">%s</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        template.name </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;string template&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        context)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> before_render_template</span></span>
<span class="line"><span style="color:#24292E;">before_render_template.connect(log_template_renders, app)</span></span></code></pre></div><h2 id="flask-request-started" tabindex="-1">flask.request_started <a class="header-anchor" href="#flask-request-started" aria-label="Permalink to &quot;flask.request_started&quot;">​</a></h2><p>This signal is sent when the request context is set up, before any request processing happens. Because the request context is already bound, the subscriber can access the request with the standard global proxies such as <code>request</code>.</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">log_request</span><span style="color:#E1E4E8;">(sender, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    sender.logger.debug(</span><span style="color:#9ECBFF;">&#39;Request context is set up&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> request_started</span></span>
<span class="line"><span style="color:#E1E4E8;">request_started.connect(log_request, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log_request</span><span style="color:#24292E;">(sender, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    sender.logger.debug(</span><span style="color:#032F62;">&#39;Request context is set up&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> request_started</span></span>
<span class="line"><span style="color:#24292E;">request_started.connect(log_request, app)</span></span></code></pre></div><h2 id="flask-request-finished" tabindex="-1">flask.request_finished <a class="header-anchor" href="#flask-request-finished" aria-label="Permalink to &quot;flask.request_finished&quot;">​</a></h2><p>This signal is sent right before the response is sent to the client. It is passed the response to be sent named <code>response</code>.</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">log_response</span><span style="color:#E1E4E8;">(sender, response, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    sender.logger.debug(</span><span style="color:#9ECBFF;">&#39;Request context is about to close down. &#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#9ECBFF;">&#39;Response: </span><span style="color:#79B8FF;">%s</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">, response)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> request_finished</span></span>
<span class="line"><span style="color:#E1E4E8;">request_finished.connect(log_response, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log_response</span><span style="color:#24292E;">(sender, response, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    sender.logger.debug(</span><span style="color:#032F62;">&#39;Request context is about to close down. &#39;</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#032F62;">&#39;Response: </span><span style="color:#005CC5;">%s</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">, response)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> request_finished</span></span>
<span class="line"><span style="color:#24292E;">request_finished.connect(log_response, app)</span></span></code></pre></div><h2 id="flask-got-request-exception" tabindex="-1">flask.got_request_exception <a class="header-anchor" href="#flask-got-request-exception" aria-label="Permalink to &quot;flask.got_request_exception&quot;">​</a></h2><p>This signal is sent when an unhandled exception happens during request processing, including when debugging. The exception is passed to the subscriber as <code>exception</code>.</p><p>This signal is not sent for <code>HTTPException</code>, or other exceptions that have error handlers registered, unless the exception was raised from an error handler.</p><p>This example shows how to do some extra logging if a theoretical <code>SecurityException</code> was raised:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> got_request_exception</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">log_security_exception</span><span style="color:#E1E4E8;">(sender, exception, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">isinstance</span><span style="color:#E1E4E8;">(exception, SecurityException):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    security_logger.exception(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;SecurityException at </span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">request.url</span><span style="color:#F97583;">!r</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">exc_info</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">exception,</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">got_request_exception.connect(log_security_exception, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> got_request_exception</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log_security_exception</span><span style="color:#24292E;">(sender, exception, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">isinstance</span><span style="color:#24292E;">(exception, SecurityException):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    security_logger.exception(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;SecurityException at </span><span style="color:#005CC5;">{</span><span style="color:#24292E;">request.url</span><span style="color:#D73A49;">!r</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">exc_info</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">exception,</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">got_request_exception.connect(log_security_exception, app)</span></span></code></pre></div><h2 id="flask-request-tearing-down" tabindex="-1">flask.request_tearing_down <a class="header-anchor" href="#flask-request-tearing-down" aria-label="Permalink to &quot;flask.request_tearing_down&quot;">​</a></h2><p>This signal is sent when the request is tearing down. This is always called, even if an exception is caused. Currently functions listening to this signal are called after the regular teardown handlers, but this is not something you can rely on.</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">close_db_connection</span><span style="color:#E1E4E8;">(sender, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    session.close()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> request_tearing_down</span></span>
<span class="line"><span style="color:#E1E4E8;">request_tearing_down.connect(close_db_connection, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">close_db_connection</span><span style="color:#24292E;">(sender, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    session.close()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> request_tearing_down</span></span>
<span class="line"><span style="color:#24292E;">request_tearing_down.connect(close_db_connection, app)</span></span></code></pre></div><p>As of Flask 0.9, this will also be passed an exc keyword argument that has a reference to the exception that caused the teardown if there was one.</p><h2 id="flask-appcontext-tearing-down" tabindex="-1">flask.appcontext_tearing_down <a class="header-anchor" href="#flask-appcontext-tearing-down" aria-label="Permalink to &quot;flask.appcontext_tearing_down&quot;">​</a></h2><p>This signal is sent when the app context is tearing down. This is always called, even if an exception is caused. Currently functions listening to this signal are called after the regular teardown handlers, but this is not something you can rely on.</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">close_db_connection</span><span style="color:#E1E4E8;">(sender, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    session.close()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> appcontext_tearing_down</span></span>
<span class="line"><span style="color:#E1E4E8;">appcontext_tearing_down.connect(close_db_connection, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">close_db_connection</span><span style="color:#24292E;">(sender, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    session.close()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> appcontext_tearing_down</span></span>
<span class="line"><span style="color:#24292E;">appcontext_tearing_down.connect(close_db_connection, app)</span></span></code></pre></div><p>This will also be passed an exc keyword argument that has a reference to the exception that caused the teardown if there was one.</p><h2 id="flask-appcontext-pushed" tabindex="-1">flask.appcontext_pushed <a class="header-anchor" href="#flask-appcontext-pushed" aria-label="Permalink to &quot;flask.appcontext_pushed&quot;">​</a></h2><p>This signal is sent when an application context is pushed. The sender is the application. This is usually useful for unittests in order to temporarily hook in information. For instance it can be used to set a resource early onto the g object.</p><p>Example usage:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> contextlib </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> contextmanager</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> appcontext_pushed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">@contextmanager</span></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">user_set</span><span style="color:#E1E4E8;">(app, user):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handler</span><span style="color:#E1E4E8;">(sender, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">kwargs):</span></span>
<span class="line"><span style="color:#E1E4E8;">        g.user </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> user</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> appcontext_pushed.connected_to(handler, app):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">yield</span></span>
<span class="line"><span style="color:#E1E4E8;">And </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> the testcode:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test_user_me</span><span style="color:#E1E4E8;">(self):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> user_set(app, </span><span style="color:#9ECBFF;">&#39;john&#39;</span><span style="color:#E1E4E8;">):</span></span>
<span class="line"><span style="color:#E1E4E8;">        c </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> app.test_client()</span></span>
<span class="line"><span style="color:#E1E4E8;">        resp </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> c.get(</span><span style="color:#9ECBFF;">&#39;/users/me&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">assert</span><span style="color:#E1E4E8;"> resp.data </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;username=john&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> contextlib </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> contextmanager</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> appcontext_pushed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">@contextmanager</span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">user_set</span><span style="color:#24292E;">(app, user):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handler</span><span style="color:#24292E;">(sender, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">kwargs):</span></span>
<span class="line"><span style="color:#24292E;">        g.user </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> user</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> appcontext_pushed.connected_to(handler, app):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">yield</span></span>
<span class="line"><span style="color:#24292E;">And </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> the testcode:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test_user_me</span><span style="color:#24292E;">(self):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> user_set(app, </span><span style="color:#032F62;">&#39;john&#39;</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">        c </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> app.test_client()</span></span>
<span class="line"><span style="color:#24292E;">        resp </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> c.get(</span><span style="color:#032F62;">&#39;/users/me&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">assert</span><span style="color:#24292E;"> resp.data </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;username=john&#39;</span></span></code></pre></div><details class="details custom-block"><summary>Changelog</summary><p><em>New in version 0.10.</em></p></details><h2 id="flask-appcontext-popped" tabindex="-1">flask.appcontext_popped <a class="header-anchor" href="#flask-appcontext-popped" aria-label="Permalink to &quot;flask.appcontext_popped&quot;">​</a></h2><p>This signal is sent when an application context is popped. The sender is the application. This usually falls in line with the <code>appcontext_tearing_down</code> signal.</p><details class="details custom-block"><summary>Changelog</summary><p><em>New in version 0.10.</em></p></details><h2 id="flask-message-flashed" tabindex="-1">flask.message_flashed <a class="header-anchor" href="#flask-message-flashed" aria-label="Permalink to &quot;flask.message_flashed&quot;">​</a></h2><p>This signal is sent when the application is flashing a message. The messages is sent as message keyword argument and the category as category.</p><p>Example subscriber:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">recorded </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> []</span></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">record</span><span style="color:#E1E4E8;">(sender, message, category, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">extra):</span></span>
<span class="line"><span style="color:#E1E4E8;">    recorded.append((message, category))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> flask </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> message_flashed</span></span>
<span class="line"><span style="color:#E1E4E8;">message_flashed.connect(record, app)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">recorded </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []</span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">record</span><span style="color:#24292E;">(sender, message, category, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">extra):</span></span>
<span class="line"><span style="color:#24292E;">    recorded.append((message, category))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> flask </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> message_flashed</span></span>
<span class="line"><span style="color:#24292E;">message_flashed.connect(record, app)</span></span></code></pre></div><details class="details custom-block"><summary>Changelog</summary><p><em>New in version 0.10.</em></p></details><h2 id="signals-signals-available" tabindex="-1">signals.signals_available <a class="header-anchor" href="#signals-signals-available" aria-label="Permalink to &quot;signals.signals_available&quot;">​</a></h2><p><em>Deprecated since version 2.3</em>: Will be removed in <code>Flask 2.4</code>. Signals are always available</p>`,48),o=[l];function t(r,c,i,y,E,d){return a(),n("div",null,o)}const u=s(p,[["render",t]]);export{g as __pageData,u as default};
